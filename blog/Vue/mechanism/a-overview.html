<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue.js 运行机制全局概览 | XXY BLOG</title>
    <meta name="description" content="xinxingyu">
    <link rel="icon" href="/blog/icon.jpg">
    
    <link rel="preload" href="/blog/assets/css/0.styles.441a5a3f.css" as="style"><link rel="preload" href="/blog/assets/js/app.1482a1b4.js" as="script"><link rel="preload" href="/blog/assets/js/25.5f79691e.js" as="script"><link rel="prefetch" href="/blog/assets/js/12.c930946a.js"><link rel="prefetch" href="/blog/assets/js/2.26886727.js"><link rel="prefetch" href="/blog/assets/js/3.132b0690.js"><link rel="prefetch" href="/blog/assets/js/4.61095209.js"><link rel="prefetch" href="/blog/assets/js/5.0cb2cb0b.js"><link rel="prefetch" href="/blog/assets/js/6.95ec952c.js"><link rel="prefetch" href="/blog/assets/js/7.95bd9774.js"><link rel="prefetch" href="/blog/assets/js/8.80fabe47.js"><link rel="prefetch" href="/blog/assets/js/9.680125a9.js"><link rel="prefetch" href="/blog/assets/js/10.49768920.js"><link rel="prefetch" href="/blog/assets/js/11.e64c64fe.js"><link rel="prefetch" href="/blog/assets/js/13.69653fe4.js"><link rel="prefetch" href="/blog/assets/js/14.93aafba3.js"><link rel="prefetch" href="/blog/assets/js/15.8e1806f6.js"><link rel="prefetch" href="/blog/assets/js/16.d32c2936.js"><link rel="prefetch" href="/blog/assets/js/17.a9a399bd.js"><link rel="prefetch" href="/blog/assets/js/18.3347ce2e.js"><link rel="prefetch" href="/blog/assets/js/19.8b631e5c.js"><link rel="prefetch" href="/blog/assets/js/20.599eb0cf.js"><link rel="prefetch" href="/blog/assets/js/21.5147bfb7.js"><link rel="prefetch" href="/blog/assets/js/22.1fca910c.js"><link rel="prefetch" href="/blog/assets/js/23.bc67bde7.js"><link rel="prefetch" href="/blog/assets/js/24.0ca4dd56.js"><link rel="prefetch" href="/blog/assets/js/26.f6dd54bd.js"><link rel="prefetch" href="/blog/assets/js/27.311f9fb6.js"><link rel="prefetch" href="/blog/assets/js/28.eb9e5eb3.js"><link rel="prefetch" href="/blog/assets/js/29.a2b66878.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.441a5a3f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container base"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">XXY BLOG</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/blog/Vue/" class="nav-link router-link-active">Vue</a></li><li class="dropdown-item"><!----> <a href="/blog/blog/CompilersPrinciples/" class="nav-link">编译原理</a></li><li class="dropdown-item"><!----> <a href="/blog/blog/Frame/" class="nav-link">Frame</a></li><li class="dropdown-item"><!----> <a href="/blog/blog/JavaScript/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/blog/blog/Css/" class="nav-link">Css</a></li></ul></div></div><div class="nav-item"><a href="/blog/about/" class="nav-link">About</a></div> <a href="https://github.com/xinxingyu" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/blog/Vue/" class="nav-link router-link-active">Vue</a></li><li class="dropdown-item"><!----> <a href="/blog/blog/CompilersPrinciples/" class="nav-link">编译原理</a></li><li class="dropdown-item"><!----> <a href="/blog/blog/Frame/" class="nav-link">Frame</a></li><li class="dropdown-item"><!----> <a href="/blog/blog/JavaScript/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/blog/blog/Css/" class="nav-link">Css</a></li></ul></div></div><div class="nav-item"><a href="/blog/about/" class="nav-link">About</a></div> <a href="https://github.com/xinxingyu" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/blog/blog/Vue/dataBinding.html" class="sidebar-link">双向数据绑定</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>mechanism</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/blog/blog/Vue/mechanism/a-overview.html" class="active sidebar-link">Vue.js 运行机制全局概览</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blog/Vue/mechanism/a-overview.html#全局概览" class="sidebar-link">全局概览</a></li><li class="sidebar-sub-header"><a href="/blog/blog/Vue/mechanism/a-overview.html#初始化及挂载" class="sidebar-link">初始化及挂载</a></li><li class="sidebar-sub-header"><a href="/blog/blog/Vue/mechanism/a-overview.html#编译" class="sidebar-link">编译</a></li><li class="sidebar-sub-header"><a href="/blog/blog/Vue/mechanism/a-overview.html#响应式" class="sidebar-link">响应式</a></li><li class="sidebar-sub-header"><a href="/blog/blog/Vue/mechanism/a-overview.html#virtual-dom" class="sidebar-link">Virtual DOM</a></li><li class="sidebar-sub-header"><a href="/blog/blog/Vue/mechanism/a-overview.html#更新视图" class="sidebar-link">更新视图</a></li></ul></li><li><a href="/blog/blog/Vue/mechanism/b-responsive.html" class="sidebar-link">响应式系统的基本原理</a></li><li><a href="/blog/blog/Vue/mechanism/c-dependencyCollection.html" class="sidebar-link">响应式系统的依赖收集追踪原理</a></li><li><a href="/blog/blog/Vue/mechanism/d-virtualDOM.html" class="sidebar-link">实现 Virtual DOM 下的一个 VNode 节点</a></li><li><a href="/blog/blog/Vue/mechanism/e-templateCompile.html" class="sidebar-link">template 模板是怎样通过 Compile 编译的</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="vue-js-运行机制全局概览"><a href="#vue-js-运行机制全局概览" aria-hidden="true" class="header-anchor">#</a> Vue.js 运行机制全局概览</h1> <h2 id="全局概览"><a href="#全局概览" aria-hidden="true" class="header-anchor">#</a> 全局概览</h2> <p>这一节笔者将为大家介绍一下 Vue.js 内部的整个流程，希望能让大家对全局有一个整体的印象，然后我们再来逐个模块进行讲解。从来没有了解过 Vue.js 实现的同学可能会对一些内容感到疑惑，这是很正常的，这一节的目的主要是为了让大家对整个流程有一个大概的认识，算是一个概览预备的过程，当把整本小册认真读完以后，再来阅读这一节，相信会有收获的。</p> <p>首先我们来看一下笔者画的内部流程图</p> <p><img src="/blog/assets/img/mechanism1.29a11c0a.jpg" alt="流程图"></p> <p>大家第一次看到这个图一定是一头雾水的，没有关系，我们来逐个讲一下这些模块的作用以及调用关系。相信讲完之后大家对Vue.js内部运行机制会有一个大概的认识。</p> <h2 id="初始化及挂载"><a href="#初始化及挂载" aria-hidden="true" class="header-anchor">#</a> 初始化及挂载</h2> <p>在 <code>new Vue()</code> 之后。 Vue 会调用 <code>_init</code> 函数进行初始化，也就是这里的 <code>init</code> 过程，它会初始化生命周期、事件、 props、 methods、 data、 computed 与 watch 等。其中最重要的是通过 <code>Object.defineProperty</code> 设置 <code>setter</code> 与 <code>getter</code> 函数，用来实现「响应式」以及「依赖收集」，后面会详细讲到，这里只要有一个印象即可。</p> <p>初始化之后调用 $mount 会挂载组件，如果是运行时编译，即不存在 render function 但是存在 template 的情况，需要进行「编译」步骤。</p> <h2 id="编译"><a href="#编译" aria-hidden="true" class="header-anchor">#</a> 编译</h2> <p>compile编译可以分成 <code>parse</code>、<code>optimize</code> 与 <code>generate</code> 三个阶段，最终需要得到 render function。</p> <h3 id="parse"><a href="#parse" aria-hidden="true" class="header-anchor">#</a> parse</h3> <p><code>parse</code> 会用正则等方式解析 template 模板中的指令、class、style等数据，形成AST。</p> <h3 id="optimize"><a href="#optimize" aria-hidden="true" class="header-anchor">#</a> optimize</h3> <p><code>optimize</code> 的主要作用是标记 static 静态节点，这是 Vue 在编译过程中的一处优化，后面当 <code>update</code> 更新界面时，会有一个 <code>patch</code> 的过程， diff 算法会直接跳过静态节点，从而减少了比较的过程，优化了 <code>patch</code> 的性能。</p> <h3 id="generate"><a href="#generate" aria-hidden="true" class="header-anchor">#</a> generate</h3> <p><code>generate</code> 是将 AST 转化成 render function 字符串的过程，得到结果是 render 的字符串以及 staticRenderFns 字符串。</p> <p>在经历过 <code>parse</code>、<code>optimize</code> 与 <code>generate</code> 这三个阶段以后，组件中就会存在渲染 VNode 所需的 render function 了。</p> <h2 id="响应式"><a href="#响应式" aria-hidden="true" class="header-anchor">#</a> 响应式</h2> <p>接下来也就是 Vue.js 响应式核心部分。
<img src="/blog/assets/img/mechanism2.6110eef3.jpg" alt="响应式"></p> <p>这里的 <code>getter</code> 跟 <code>setter</code> 已经在之前介绍过了，在 init 的时候通过 <code>Object.defineProperty</code> 进行了绑定，它使得当被设置的对象被读取的时候会执行 <code>getter</code> 函数，而在当被赋值的时候会执行 <code>setter</code> 函数。</p> <p>当 render function 被渲染的时候，因为会读取所需对象的值，所以会触发 getter 函数进行「依赖收集」，「依赖收集」的目的是将观察者 Watcher 对象存放到当前闭包中的订阅者 Dep 的 subs 中。形成如下所示的这样一个关系。</p> <p><img src="data:image/jpeg;base64,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" alt></p> <p>在修改对象的值的时候，会触发对应的 <code>setter</code>， <code>setter</code> 通知之前 <strong>「依赖收集」</strong> 得到的 Dep 中的每一个 Watcher，告诉它们自己的值改变了，需要重新渲染视图。这时候这些 Watcher 就会开始调用 <code>update</code> 来更新视图，当然这中间还有一个 <code>patch</code> 的过程以及使用队列来异步更新的策略，这个我们后面再讲。</p> <h2 id="virtual-dom"><a href="#virtual-dom" aria-hidden="true" class="header-anchor">#</a> Virtual DOM</h2> <p>我们知道，render function 会被转化成 VNode 节点。Virtual DOM 其实就是一棵以 JavaScript 对象（ VNode 节点）作为基础的树，用对象属性来描述节点，实际上它只是一层对真实 DOM 的抽象。最终可以通过一系列操作使这棵树映射到真实环境上。由于 Virtual DOM 是以 JavaScript 对象为基础而不依赖真实平台环境，所以使它具有了跨平台的能力，比如说浏览器平台、Weex、Node 等。</p> <p>比如说下面这样一个例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    tag<span class="token punctuation">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>                 <span class="token comment">/*说明这是一个div标签*/</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span>                 <span class="token comment">/*存放该标签的子节点*/</span>
        <span class="token punctuation">{</span>
            tag<span class="token punctuation">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span>           <span class="token comment">/*说明这是一个a标签*/</span>
            text<span class="token punctuation">:</span> <span class="token string">'click me'</span>    <span class="token comment">/*标签的内容*/</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>渲染后可以得到</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span>click me<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这只是一个简单的例子，实际上的节点有更多的属性来标志节点，比如 isStatic （代表是否为静态节点）、 isComment （代表是否为注释节点）等。</p> <h2 id="更新视图"><a href="#更新视图" aria-hidden="true" class="header-anchor">#</a> 更新视图</h2> <p><img src="data:image/jpeg;base64,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" alt></p> <p>前面我们说到，在修改一个对象值的时候，会通过 <code>setter -&gt; Watcher -&gt; update</code> 的流程来修改对应的视图，那么最终是如何更新视图的呢？</p> <p>当数据变化后，执行 render function 就可以得到一个新的 VNode 节点，我们如果想要得到新的视图，最简单粗暴的方法就是直接解析这个新的 VNode 节点，然后用 innerHTML 直接全部渲染到真实 DOM 中。但是其实我们只对其中的一小块内容进行了修改，这样做似乎有些「浪费」。</p> <p>那么我们为什么不能只修改那些 <strong>「改变了的地方」</strong> 呢？这个时候就要介绍我们的「<code>patch</code>」了。我们会将新的 VNode 与旧的 VNode 一起传入 patch 进行比较，经过 diff 算法得出它们的 <strong>「差异」</strong> 。最后我们只需要将这些 <strong>「差异」</strong> 的对应 DOM 进行修改即可。</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/blog/Vue/dataBinding.html" class="prev">
          双向数据绑定
        </a></span> <span class="next"><a href="/blog/blog/Vue/mechanism/b-responsive.html">
          响应式系统的基本原理
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/blog/assets/js/25.5f79691e.js" defer></script><script src="/blog/assets/js/app.1482a1b4.js" defer></script>
  </body>
</html>
